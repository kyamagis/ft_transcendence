## 不思議な振る舞い

```javascript
// module.js
console.log('This will be logged when the module is imported');
export const value = 1;
```

このモジュールをインポートするとき、`console.log` が実行されます：

```javascript
// main.js
import { value } from './module.js';
```

実行すると `This will be logged when the module is imported` と表示されます。

## 仕組み
モジュール（ファイル）内のコードをすべて評価する。
評価することの振る舞いは、その対象ごとに捉えなければならない。
変数宣言や初期化、代入なら、その変数がインポート先（実行環境）に取り込まれる。
関数宣言と定義なら、関数呼び出し可能な関数として取り込まれる。
そして、関数呼び出しがあったら、それを評価するとは、すなわち関数の実行になる。
したがって、上記の”不思議な振る舞い”が発生する。

## 補足

また、この動作はES Module（`import`/`export`）でもCommonJS（`require`/`module.exports`）でも同様で、モジュール内の全てのコードが評価されます。

デフォルトエクスポートと名前付きエクスポートでは、この動作に違いはありません。どちらのタイプのエクスポートを使用しても、モジュール内のコード全体が評価され、トップレベルの関数呼び出しやステートメントが実行されます。

ただし、これはモジュールの初回のインポート時のみに適用され、2回目以降の同一モジュールのインポートでは既に評価された結果がキャッシュから使用されます。

なお、モジュールの初期化や副作用のためにトップレベルのコードを実行するという動作は一般的には推奨されません。それよりも、必要になったときに実行される関数をエクスポートする方がより良い設計とされています。
