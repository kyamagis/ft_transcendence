# 仮想DOM

作成者: FukumaNaoya
最終更新日時: 2023年7月11日 15:18

仮想DOMは、実際のDOMとは別にメモリ上に存在する、軽量のJavaScriptオブジェクトの構造体です。Reactなどのフロントエンドフレームワークでは、アプリケーションの状態が変わるたびに新しい仮想DOMツリーを作成し、それと前の仮想DOMツリーとを比較します。

この比較（通常は「差分計算」や「再調整」と呼ばれます）により、アプリケーションの状態が変わった結果、どのDOMノードが追加、更新、または削除されるべきかを特定できます。その後、必要な変更だけを実際のDOMに適用します。これは「バッチ更新」と呼ばれます。

実際のDOM操作は比較的高コストであるため（特に大規模なアプリケーションで）、この差分計算とバッチ更新のアプローチにより、必要な操作を最小限に抑えてパフォーマンスを最適化できます。つまり、仮想DOMは、実際のDOMを効率的に操作するための一種の「中間層」や「抽象化」を提供するわけです。

はい、その理解は基本的に正確です。仮想DOMは、前の状態と新しい状態との間の差分を計算します。もし前の状態（つまり、前の仮想DOMツリー）が利用できない場合、新たに生成された仮想DOMツリーは初期状態として考えられ、新しい状態の全ての部分がDOMの更新対象となります。

ただし、これは理論的な話であり、実際にはフレームワーク（例えばReact）はアプリケーションのライフサイクルの中で常に最新の仮想DOMの状態を追跡します。そのため、通常は全ての差分が更新対象となるような状況はありません。これにより、フレームワークは可能な限り効率的にDOMの更新を行い、パフォーマンスを最適化することができます。